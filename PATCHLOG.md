# PATCHLOG

## v2.1.2
- 프로젝트에 [uv](https://docs.astral.sh/uv/) 적용
- 테스트 코드 일부 작성
- 디렉토리 구조 일부 변경

## v2.1.1
- 마이너 버그 수정

## v2.1.0
- 내부 구조 개선
  - SIGHUP 대응 (프로그램 종료 없이 `dump.json` 저장 및 `config.json` 불러오기)
  - `asyncio.get_event_loop()` 대신 `asyncion.new_event_loop()` 사용
  - 오류 발생으로 HTTP 응답을 `error/` 에 저장할 때 텍스트 인코딩 과정 없이 바이너리 그대로 파일에 쓰도록 개선
  - 기본 세션 타임아웃 시간을 30초에서 20초로 변경
- 루리웹 크롤러 작성자 파싱 오류 수정
- 뽐뿌 크롤러가 글을 파싱하지 못하는 오류 수정
- 인코딩이 `euc_kr` (완성형) 인 경우에도 `cp949` (확장 완성형) 사용하도록 개선
  - 기존에는 `euc-kr` 일 때만 해당 방식 사용.
- 퀘이사존 크롤러 직배 여부 파싱 추가 및 구현 방식 개선
- 오류 처리 및 기록 과정 개선
- 크롤러 추가
  - [다모앙 알뜰구매 게시판](https://damoang.net/economy)
  - [에펨코리아 핫딜 게시판](https://www.fmkorea.com/hotdeal)

## v2.0.4 (2023-08-22)
- 오류 예외 처리 및 기록 개선

## v2.0.3 (2023-08-20)
- 텔레그램 로거 추가 개선
- Timeout 오류 관련 예외 처리 추가

## v2.0.2 (2023-07-22)
- 텔레그램 로거 관련 개선

## v2.0.1 (2023-07-17)
- 보내진 메시지를 삭제하지 못하는 문제 수정
  - 텔레그램 채널의 메시지를 삭제하기 전에 본 앱의 메모리에서 메시지 객체를 지워버려서 생긴 문제;;
- 안정성 강화
- 로깅 강화
- [config.json.example](/config.json.example) 파일에서 뽐뿌 주소가 http로 되어있던 문제 수정.
- 디버깅 및 테스트를 위해 `DummyBot` 및 `DummyCrawler` 구현
  - `bot.DummyBot` 은 어딘가로 메시지를 보내지 않습니다.
  - `crawler.DummyCrawler` 는 매 크롤링 시도마다 1개의 게시글 밀어내기/수정/삭제, 2개의 신규 게시물 등록을 구현합니다.

## v2.0.0 (2023-07-14)
- 내부 구조 변경
  - [config.json](/config.json) 파일 구조 변경 ([README](/README.md#how-to-use) 참조)
- 크롤러 및 메시지 전송 봇 목록을 json 파일에서 불러오게 개선
- 데이터 저장 방식 변경
- 메시지 전송 구조 변경 (비동기 큐 방식)
  - 일부 메시지에서 발생하던 수정 불가능하게 되는 오류도 같이 해결
- python-telegram-bot 패키지 버전 변경 및 비동기 적용
- 기존 `dump.json` 파일을 신규 버전으로 변경해주는 [migration.py](/migration.py) 작성
- 그 외에도 이것저것 많이 고친 것 같은데 까먹음
- 아카라이브 크롤러 주소 파싱 오류 수정

## v1.1.19 (2023-06-20)
- 뽐뿌 크롤러가 게시물 목록 불러오지 못하던 오류 수정
- [README.md](README.md) 업데이트

## v1.1.18 (2023-06-17)
- 쿨앤조이 RSS 링크 및 작동 오류 수정 (2023-04-28 이후로 계속 쿨앤조이 크롤링이 진행되고 있지 않았던 것을 확인)

## v1.1.17 (2023-06-16)
- 아카라이브 크롤러가 제목을 저장할 때 같이 표기되는 댓글의 개수도 같이 저장하는 문제 수정.

## v1.1.16 (2023-02-22)
- 크롤링 대상 사이트 점검시의 작동 방식 개선
- 로깅 개선
- `User-Agent` 업데이트

## v1.1.15 (2023-02-22)
- 클리앙 크롤러가 (핫딜 게시글이 아닌) 시위성 게시글 일부를 크롤링하지 않도록 수정

## v1.1.14 (2022-12-20)
- `인증` 표시가 달려있는 루리웹 글을 파싱하지 못하는 오류 수정

## v1.1.13(a) (2022-12-18)
- [아카라이브 핫딜 채널](https://arca.live/b/hotdeal) 추가

## v1.1.12 (2022-09-21)
- 뽐뿌 크롤러의 카테고리 없는 게시글로 인한 오류 수정

## v1.1.11(a)
- 쿨앤조이 크롤러의 일부 오류 수정

## v1.1.10 (2022-05-03)
- 크롤링 타임아웃 설정 및 로깅 강화

## v1.1.9 (2022-02-26)
- 퀘이서존 크롤러 변경 (모바일 페이지 -> PC 페이지) 및 개선

## v1.1.8 (2022-02-26)
- 퀘이서존 크롤러 오류 일부 수정

## v1.1.7 (2022-02-19)
- aiohttp 라이브러리의 `Cannot guess the encoding of a not yet read body` 오류 개선

## v1.1.6 (2022-02-18)
- 클리앙 크롤링 과정의 오류 수정

## v1.1.5 (2022-01-24)
- 텔레그램 메시지 재전송 시도 추가
- 웹페이지 요청 실패시 재시도 추가
- 로깅 개선

## v1.1.4 (2022-01-17)
- 텔레그램 메시지 전송 실패시 재시도 기능 추가
- 안정성 강화
- 로깅 개선

## v1.1.3 (2022-01-13)
- 로깅 개선

## v1.1.2 (2022-01-04)
- 퀘이사존 블라인드 처리된 게시글 처리 코드 추가
- 안정성 강화
- 봇 내부 데이터 저장 및 복구 기능 추가
- 로깅 개선

## v1.1.1 (2021-12-27)
- 퀘이사존 메시지 전송이 정상적으로 되지 않는 문제 수정
- 루리웹 게시글 제목의 불필요한 공백 문자 제거
- 로깅 강화

## v1.1.0 (2021-12-27)
- [퀘이사존 지름/할인정보](https://quasarzone.com/bbs/qb_saleinfo) 추가
- 카테고리 정보 파싱 기능 추가

## v1.0.1 (2021-12-26)
- 기존 메시지를 수정하지 못하는 등의 버그 수정
- 오타 수정
- 로깅 레벨 일부 조정
- 크롤러의 HTTP 요청에 대한 예외 핸들링 추가

## v1.0.0 (2021-12-26)
- 첫 버전
- 개발 소요 시간 약 40시간
